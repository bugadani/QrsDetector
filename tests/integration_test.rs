// 10s long noisy signal of a 72bpm. fs=200Hz simulated ECG waveform
// slice because I don't care how long it is
const SIGNAL: &[f32] = &[
    88.5218766374807,
    181.435086210935,
    8.93392477465385,
    189.038160854544,
    36.0760719381272,
    73.9816292075513,
    41.0478164705034,
    19.1171689682936,
    86.5481869597632,
    55.5121882512897,
    20.1716419769265,
    99.7840908919131,
    47.8068147050814,
    69.9202662368126,
    111.652458058817,
    109.613382212851,
    84.2547861083366,
    77.0999332201083,
    76.1327558359454,
    56.1456725742752,
    35.9824768501403,
    25.4568049583084,
    3.13804489563416,
    150.617593858352,
    100.991037550388,
    144.422047956200,
    152.220161011712,
    53.7897759157303,
    38.7243965314511,
    12.8297579128950,
    85.0748634753105,
    140.429397813677,
    195.464129029618,
    110.316546400792,
    8.76135533009723,
    116.429754177135,
    55.6751469837542,
    108.438849800777,
    88.6641786751402,
    23.4410860309427,
    75.9882441458888,
    152.966577024490,
    183.673658355973,
    138.539811125826,
    194.124848785612,
    25.2329933145991,
    129.282777104385,
    77.3699910813215,
    112.468918105970,
    39.6701166552159,
    78.7852630461564,
    68.0484521276379,
    71.2955539866460,
    74.6079779262156,
    23.0728462490445,
    100.241951636069,
    163.382564121524,
    68.7013988357006,
    99.7072393490580,
    23.6047965246377,
    115.103334666128,
    103.092849135770,
    71.0553360356133,
    172.669786265669,
    68.8029962234359,
    91.3762762840945,
    47.6177823541624,
    154.232616042609,
    54.6809043762786,
    105.000422593511,
    106.222691681789,
    174.676837298351,
    187.522606745759,
    9.74349600083688,
    195.768982753942,
    126.465172770632,
    14.5267624504213,
    42.3648023579977,
    71.9774446708009,
    85.3362560160105,
    151.629074925361,
    183.150153338966,
    125.948029931195,
    191.181822516120,
    151.023687426047,
    105.222234502399,
    170.022199586140,
    163.206184963928,
    26.4260941822492,
    152.144833711266,
    123.446493622090,
    79.5294437329876,
    168.254396797648,
    7.66394142755460,
    19.2411856080393,
    189.620447249094,
    79.2031229065755,
    156.452419560877,
    380.728495766582,
    418.007048228664,
    632.779128984251,
    795.472213005702,
    844.602720110943,
    1061.09080637217,
    1191.04653401753,
    1372.05290759593,
    1333.79800761662,
    1178.67126779601,
    982.209549398725,
    950.803232664010,
    812.308607394481,
    636.241856390870,
    518.816985422681,
    279.846984440732,
    47.5737870228019,
    5.04688777241563,
    -61.8228064482260,
    171.387167054035,
    188.570614492402,
    20.6893799438787,
    59.2877894377790,
    159.806806119058,
    88.3429518450400,
    98.5041122909235,
    5.90323447010728,
    114.528677076388,
    114.492433263192,
    148.338273717276,
    15.3211125901222,
    157.433293209155,
    38.6989989962102,
    106.185540838034,
    349.161505807441,
    426.272716629794,
    471.444078800778,
    375.223451576525,
    496.558225867112,
    413.949019288818,
    568.048555110088,
    547.308542278560,
    453.453853090604,
    563.996168981541,
    653.339988108172,
    640.379050619071,
    630.944059350234,
    628.107983978992,
    542.331378395318,
    504.892294078231,
    591.650434963074,
    523.474762407821,
    531.551793689570,
    580.855162969234,
    626.229719334510,
    682.128900489611,
    536.252766904547,
    577.683113798952,
    646.780863517201,
    481.235689490695,
    590.862648539417,
    436.332779150703,
    572.496951566130,
    477.125518863304,
    540.655827657241,
    465.490519422907,
    420.899413905517,
    229.581661300629,
    205.458294999082,
    52.0738377346638,
    15.9909406929693,
    147.065546676618,
    164.530135010558,
    68.6781272599545,
    27.2276198833758,
    133.177885383743,
    166.088227841249,
    134.724174062552,
    27.8918195844898,
    75.7653767894592,
    135.672588235130,
    103.185018477956,
    195.611074917573,
    53.5449397311540,
    173.382100130009,
    74.7509736913112,
    27.3260685657613,
    16.5383091937208,
    147.764737365264,
    74.4135608817578,
    76.1032600348351,
    60.4347529684784,
    58.9050813085631,
    51.9627130990544,
    92.6950030824508,
    197.570454809394,
    77.0151757534467,
    188.646841281792,
    33.4002396848996,
    185.000811834432,
    150.867473515864,
    171.319887342943,
    120.477303341399,
    21.4733643139661,
    91.0944514430704,
    130.917942097552,
    11.5066241563708,
    4.25257536924899,
    57.9603480326655,
    186.295766254622,
    102.803871491318,
    175.059686073645,
    75.6199023330955,
    176.902303908594,
    106.954774029631,
    178.520547060269,
    20.5526853343658,
    42.4091665628322,
    140.321147902509,
    72.2701659170110,
    0.279142941609134,
    76.8616679707368,
    64.0285824786500,
    78.6690765184029,
    36.2502446552567,
    41.8753442100934,
    118.744926592144,
    118.893271135415,
    34.4940562816889,
    186.600313329717,
    11.2433538467031,
    40.3448283485752,
    101.650412995301,
    151.842971917323,
    29.2104183594835,
    186.214597237608,
    84.3896130848582,
    11.2997474780763,
    134.840087769046,
    55.9617464543277,
    156.017408651952,
    192.568243207517,
    137.648967330561,
    99.6845120408984,
    19.8064920101063,
    57.5502494624937,
    107.622456560115,
    2.26601027673803,
    56.5686969150340,
    117.914258135162,
    34.4096223749904,
    34.0196330658398,
    135.268558762607,
    113.918886181334,
    110.334100237473,
    193.488196912132,
    125.684380412605,
    64.9099435030479,
    104.203138173514,
    172.987335217509,
    198.821646957310,
    167.697646028190,
    69.4794295866097,
    149.881975957398,
    187.882566547573,
    133.616367745381,
    196.240543476184,
    307.232615400290,
    519.031161119844,
    617.281428961178,
    891.910113492019,
    938.415004343803,
    1192.39924169274,
    1285.27672407281,
    1441.21556735156,
    1366.53855063084,
    1212.97538756221,
    1041.75150697474,
    756.048264163708,
    741.086434938664,
    517.828064593866,
    334.737685535600,
    229.661063948257,
    141.326087028788,
    -67.1735294381159,
    1.96637193419220,
    70.8076852275305,
    37.3476272146491,
    70.1313468217196,
    37.9437070267443,
    167.138187644649,
    76.8301911197165,
    1.89994447626844,
    61.8049390443900,
    167.349446840562,
    56.2673642325065,
    156.268662419901,
    106.302849848788,
    30.7829031425828,
    105.050736831911,
    56.6479575491361,
    307.308772432335,
    375.939280629491,
    366.312567809027,
    350.685167324206,
    372.938629670101,
    427.232318983061,
    522.901113892145,
    576.977293326568,
    566.588166427993,
    505.221037698627,
    489.130644544007,
    520.579567844712,
    618.702082307537,
    501.847390223350,
    592.738823618674,
    694.103550466258,
    680.207927919642,
    615.041539502538,
    652.531253560664,
    646.257484694440,
    632.072929986475,
    622.961471650073,
    536.802645155590,
    587.778116836832,
    584.416790171200,
    610.751191606242,
    436.210113980177,
    458.610230404408,
    593.345884176262,
    536.145447006806,
    472.246886535202,
    450.699169842097,
    438.028763777614,
    284.993851282150,
    297.329403112442,
    5.86482246953894,
    108.876030849550,
    105.794049157447,
    174.632855630883,
    37.5216607640340,
    186.292114944672,
    195.270455184073,
    66.2408855170033,
    124.741846827004,
    105.412143701201,
    91.8163043055325,
    71.7131251418227,
    66.8539102906162,
    16.6390499775791,
    78.0803736792909,
    47.8687891889659,
    97.2543978392801,
    140.018720920662,
    27.4540663031034,
    165.293467743907,
    186.010643906131,
    165.746101377579,
    96.9905525496890,
    131.953852790573,
    91.2802163827016,
    83.6924108369198,
    6.85925239999266,
    185.369509265200,
    8.67601113626637,
    95.2120198553081,
    77.1495469467593,
    106.811666849318,
    199.633654256934,
    180.494837659946,
    2.95109967040639,
    156.102985757896,
    97.0578900830756,
    78.0439529108634,
    164.618020972321,
    174.883508912424,
    199.671205285842,
    39.1321178575120,
    173.993783637881,
    61.4983237267239,
    82.2472906741869,
    163.268039708266,
    73.6509494862434,
    85.2430850744517,
    18.2433620696413,
    133.499636249962,
    146.261632224713,
    60.1636819453172,
    67.5994418656762,
    146.864471961353,
    197.091324065723,
    139.754202773771,
    17.9863625399246,
    94.1475052961792,
    127.072577599130,
    105.053871039079,
    28.2678873734425,
    55.1030963639426,
    197.420546898578,
    158.999661571478,
    186.666982063453,
    69.6745117438598,
    41.8266964476424,
    136.073102870364,
    71.0847585896197,
    87.6746292612417,
    181.755635879843,
    166.717991892006,
    78.2767630928196,
    146.795819857161,
    58.1320070135068,
    58.4273288927651,
    59.3592554769901,
    4.96848433313248,
    183.568362641841,
    137.206024516873,
    46.8555710305707,
    99.4705280282043,
    158.116310186189,
    76.0465235851864,
    43.7166825179799,
    144.533055447839,
    154.566511413789,
    138.656531022414,
    123.934958942228,
    152.460608192453,
    102.296059141476,
    65.8810933975887,
    0.268812306806088,
    116.128810045146,
    34.3676137927980,
    38.9814441702770,
    30.0643016576404,
    251.083945040091,
    303.477384986104,
    544.241590532303,
    609.215498825527,
    838.453049740055,
    932.711838779971,
    1164.41999108305,
    1363.66406454758,
    1292.06839613296,
    1171.56721863279,
    1024.20920649653,
    895.386842654545,
    756.816818165748,
    547.848622955521,
    456.442954252431,
    360.186141654614,
    183.604788150009,
    -3.57407687070535,
    -17.6814538647245,
    135.740558044173,
    26.3120366312278,
    87.9239223092945,
    187.439115104783,
    114.044772114695,
    115.527858232366,
    152.920474061764,
    49.3903336966346,
    138.771085161774,
    58.9725823659423,
    114.140106167415,
    126.960833114385,
    79.7782394454313,
    49.7767379026141,
    187.066476182933,
    254.115929817482,
    335.418227118399,
    403.353109179719,
    447.893752798790,
    433.633182132829,
    407.275869151787,
    534.649260757207,
    600.724951683336,
    507.133890818924,
    575.660785306203,
    638.578149308475,
    567.992987542205,
    606.286253281112,
    580.501520317784,
    514.841220692163,
    519.527270542628,
    520.806260469820,
    589.146191635509,
    686.996806091986,
    623.666790660044,
    678.940518206504,
    500.073272700424,
    541.710461937183,
    661.357419866016,
    462.715207811580,
    481.468749923945,
    584.067191502684,
    582.504056096706,
    516.944499742753,
    476.261429923808,
    534.402065044052,
    462.510959637341,
    416.601172597404,
    378.005053450567,
    339.100704254895,
    192.824119189488,
    196.383381459125,
    183.726565547272,
    56.6960732984032,
    11.7251150216811,
    164.198909387176,
    35.9044470106754,
    6.98625435359468,
    154.265342772328,
    108.105223867689,
    66.3079911721811,
    115.643321242445,
    170.901484363689,
    128.475016816304,
    84.0207064813844,
    109.182577239132,
    36.4595456729754,
    47.2548454261059,
    41.0827333471972,
    51.9372625177012,
    188.526481236593,
    128.314071509650,
    165.812673385949,
    77.7524387233053,
    33.6824435761969,
    148.023548080578,
    174.559170070747,
    71.1049951018194,
    35.7657342348236,
    199.284721583928,
    191.825511775526,
    31.1992474018420,
    185.787133055006,
    84.9148373534950,
    44.6167890145596,
    27.2790185172512,
    52.0351308223996,
    108.893076597952,
    16.4416784038850,
    119.625462665309,
    5.83723567987367,
    90.9817795375809,
    66.4997368377220,
    188.734566311168,
    60.6203640019386,
    85.6448672996251,
    132.206751965951,
    76.2176024072890,
    27.2341223251630,
    19.3253246086754,
    61.0323283142964,
    164.776729972941,
    125.450573206600,
    41.1865528312595,
    196.037091607517,
    87.5548560266575,
    167.039154847979,
    107.836089592208,
    5.02538663767187,
    1.36485582540635,
    157.217247703627,
    89.4785711832917,
    57.7474898817475,
    172.636052984888,
    131.245699023012,
    56.9387265817957,
    128.913244947058,
    52.7162357144529,
    34.9557328562963,
    73.7239001243402,
    107.508444638231,
    185.281431419711,
    149.824145889820,
    29.5470973236712,
    0.577549019122459,
    25.4027787235350,
    183.384270425024,
    134.424341450660,
    22.7579614902128,
    192.045498563499,
    23.8766241934889,
    98.4831390906289,
    72.2626803904406,
    94.0000981095988,
    11.7559537641936,
    66.0023402346235,
    52.9040955315593,
    49.1835332729903,
    189.535271879267,
    6.48839890114721,
    181.230126823181,
    73.6995408280906,
    132.508074622564,
    190.724926098956,
    18.8256914111532,
    137.063124385764,
    82.4880964330678,
    72.3577445416513,
    298.367012615676,
    442.310476755785,
    675.411628211965,
    782.047835495437,
    855.592967682500,
    1081.43364320734,
    1229.08299003244,
    1429.44474896531,
    1401.46731238513,
    1142.03448514737,
    1010.40038569015,
    935.752997731657,
    809.618840920043,
    648.344768029203,
    424.930054507921,
    291.896608969741,
    209.951400291311,
    -91.7766204796097,
    -25.1279723813777,
    51.8816062232746,
    166.096183336041,
    14.0353373466302,
    56.2060554321837,
    111.008967520080,
    123.793376108541,
    81.9574174474122,
    51.6856890593289,
    83.3492319760346,
    76.4111077911508,
    19.2668265988261,
    26.2568438787395,
    121.979654083510,
    131.238746375869,
    168.199062508879,
    264.299125150462,
    290.501039948764,
    310.338183584655,
    324.022759134949,
    390.993970588875,
    446.072213233220,
    509.341689450714,
    529.682791030437,
    588.767997436930,
    565.951518052361,
    482.775024692708,
    599.540109473839,
    494.726544854837,
    560.667180879221,
    550.467261578271,
    645.191615170709,
    512.625284917017,
    651.433191091016,
    547.370405475223,
    543.085962203613,
    495.404325031535,
    513.992946686276,
    522.199989301102,
    514.241064067842,
    641.801206050234,
    503.457708518974,
    452.433099777579,
    572.304014975654,
    529.276601386886,
    495.212505955653,
    414.589028646517,
    452.337458820171,
    323.097193276815,
    290.667308976349,
    235.795690537706,
    43.3395864734017,
    135.456000856609,
    147.202942748166,
    2.00371410163267,
    71.1828628387545,
    47.9909166003126,
    185.521746272645,
    152.597363244710,
    75.8774205366793,
    137.191255132765,
    139.774534643875,
    118.079647008163,
    192.411107094583,
    156.269130634409,
    107.685495812380,
    18.8276502033386,
    177.201737022198,
    51.4990266880533,
    92.7013731752393,
    66.1596540182520,
    151.354677537320,
    160.569867065598,
    160.623538178722,
    175.327372065743,
    17.4948135088083,
    133.582724980741,
    100.484394505871,
    67.1124081332172,
    117.712293885174,
    70.3865173945820,
    41.3435306897572,
    52.4309092592809,
    19.7298605811441,
    30.0126379040875,
    64.2038688269806,
    118.877891032290,
    30.7476124630036,
    12.5251198276627,
    1.55644601145346,
    154.852025589050,
    136.409003829165,
    24.1006309985488,
    143.850679859270,
    32.3708207498615,
    24.0320299905932,
    136.230421220729,
    28.9653311989976,
    11.5655504355554,
    26.9884005739911,
    2.95608770085605,
    37.8234302560178,
    14.1724236575809,
    7.57195012009391,
    61.5740416261389,
    103.147109204744,
    78.7021480309199,
    199.039102821123,
    87.9199958888785,
    30.2879294064311,
    155.610105899803,
    148.234692725453,
    17.5287444590571,
    94.0851416963296,
    58.5659220167042,
    81.3701164051058,
    86.0474495087005,
    174.252428043991,
    141.450027443546,
    2.85946625493103,
    4.91674168925977,
    47.3988494340403,
    119.653087253755,
    185.239630658122,
    66.8826977645755,
    88.6065878325833,
    19.8276113438977,
    143.030241053574,
    144.327681322027,
    156.494190550281,
    188.409020187326,
    9.51369531213382,
    160.070077589526,
    93.3576810748109,
    55.8279699355565,
    8.94421642256653,
    157.510193713403,
    179.824772284792,
    155.136779935488,
    167.490047116418,
    68.8841411760659,
    38.2385207591354,
    75.6877847720121,
    51.2667683100316,
    4.29264796185154,
    58.6557569561008,
    48.0845555028742,
    40.5178017821172,
    169.644156118567,
    357.429919331368,
    424.862854524466,
    588.547661934120,
    797.723907891047,
    931.402080820543,
    1146.98376874874,
    1209.98098379344,
    1461.42722829022,
    1357.73290343367,
    1178.02160825994,
    941.842339225307,
    868.867586956060,
    581.718632914895,
    548.124779385813,
    297.436973151512,
    135.120431635672,
    -13.9579501504045,
    -169.756080646171,
    141.087116360036,
    105.042760699599,
    151.250803030765,
    117.963663629435,
    147.781126791973,
    63.8833998727792,
    169.625966741746,
    98.7293642857349,
    22.9670556417688,
    162.454476435645,
    133.365832007918,
    76.3566167828023,
    143.761792868979,
    83.7255788606430,
    11.1865418801851,
    116.999932116417,
    224.101094170279,
    310.973939403648,
    393.603340451258,
    377.393993523017,
    375.302233889457,
    570.983851325529,
    417.271061229411,
    482.591076475281,
    440.604493945020,
    632.384527838671,
    535.270685420392,
    669.236664957076,
    589.013885824013,
    600.161324881847,
    530.586372313525,
    540.003120749675,
    596.289177839836,
    543.900147461072,
    686.602308439440,
    552.428922247049,
    683.627356308031,
    650.484523680415,
    550.242440529591,
    475.725729743792,
    528.844940612300,
    524.782770623668,
    451.670626976908,
    609.590264983532,
    433.781403900609,
    405.602089036676,
    447.236832993624,
    415.917335170529,
    286.681029447333,
    302.463763812838,
    281.294996855736,
    198.950118366832,
    87.0263545716065,
    139.199557696676,
    3.29509910279411,
    30.5080191006249,
    179.907770455672,
    9.27526027646499,
    5.86539791792697,
    114.888898259186,
    68.0808331316941,
    43.8601534491098,
    180.798210875003,
    136.617568304560,
    74.3296294866083,
    80.2235672985643,
    40.9940539093257,
    47.5398387599959,
    176.872129189496,
    184.248611136869,
    156.329772453816,
    48.3831576023298,
    116.719260453863,
    40.3711380947316,
    25.4135536747188,
    137.533864265624,
    182.147802235033,
    150.188013973673,
    164.581780867225,
    45.0241704896093,
    77.3492608898391,
    83.7376904090526,
    187.157132459126,
    21.1109698514191,
    106.257854421425,
    124.238331459131,
    56.0683506549932,
    39.5525269208596,
    81.6773821494085,
    72.5209145564175,
    32.3802785807859,
    178.705096627691,
    88.0952733317844,
    134.062003904018,
    42.0853478636527,
    94.2292460552916,
    9.98276830987019,
    99.1863035410498,
    53.9442388833920,
    136.834861552556,
    149.599123858201,
    78.3282737774733,
    111.765409141051,
    146.449122828102,
    122.324348931422,
    116.245932887317,
    14.1207854503706,
    74.8492622920718,
    6.71792446393689,
    81.2286179336970,
    131.591622453888,
    115.048108964997,
    195.191247622739,
    88.3278676337690,
    155.567394711805,
    113.891685171843,
    4.21995697577164,
    102.454710519083,
    81.5104290476105,
    43.9674147392914,
    46.0921336095076,
    87.7099566924901,
    183.978766172891,
    63.8075134995139,
    56.8669073852087,
    72.7558015728378,
    99.8635086196309,
    162.704856187137,
    46.9636497044691,
    4.45278721120297,
    60.2242827445469,
    59.6124472290189,
    165.185595294592,
    27.2790878795405,
    162.916081129652,
    172.217670985656,
    110.588365138252,
    3.70597355558993,
    101.564296109989,
    142.729026637017,
    139.549594787343,
    178.691119188373,
    140.236994107338,
    187.458076109834,
    2.17855471187705,
    163.948080755320,
    6.85353083133138,
    103.232064195112,
    280.666064073926,
    450.825452505261,
    505.999394988720,
    720.610212008867,
    927.756146490699,
    1028.64682138804,
    1207.21267070112,
    1298.22824841440,
    1355.69208111784,
    1300.48801955674,
    1116.63658537330,
    990.298321206430,
    677.134083251652,
    544.111428457845,
    483.656850549885,
    396.243489473996,
    127.871186781802,
    80.1094520282891,
    -22.4158501656130,
    145.011951012795,
    178.929522477251,
    153.597400909626,
    41.3693676925779,
    8.66083150804577,
    30.7127113775657,
    143.662712824118,
    25.7287011782163,
    44.1577847304549,
    90.7118882978637,
    93.0521703943381,
    17.9572516229287,
    101.345929012397,
    15.3018196705133,
    33.3049391744869,
    313.877557356031,
    295.974875709091,
    337.396203429305,
    478.045391079748,
    542.240333463416,
    566.471997929060,
    511.096879519775,
    462.436307862113,
    491.432392259994,
    582.656074614806,
    575.390072348641,
    511.344970616976,
    671.962359028238,
    554.728999600200,
    522.939469652304,
    562.580638612138,
    521.847134080511,
    654.382895206169,
    657.740302637806,
    614.317751213556,
    508.844972776826,
    526.078419406524,
    635.403706644909,
    542.082808248444,
    628.431888960761,
    474.680659733937,
    572.642290009224,
    453.808635247700,
    475.133791486205,
    440.467461107883,
    530.369095756522,
    481.950202278590,
    402.290209766504,
    402.159553607978,
    207.593467866760,
    12.9798169811281,
    135.600106889652,
    107.024038047247,
    103.469846726575,
    51.1437336915213,
    170.565517547362,
    164.640212214986,
    3.31444204178561,
    94.9420007225962,
    188.823713953556,
    91.7241085479364,
    169.994459982382,
    107.110478290474,
    86.8202562318730,
    4.88674102599096,
    100.871956152547,
    175.296791062708,
    181.649763656974,
    57.0406968665325,
    26.5407323952516,
    0.0265087090891125,
    63.5921421010011,
    106.021599996151,
    165.835224140992,
    134.716706461243,
    182.602899729014,
    151.228385288386,
    33.7024854575089,
    192.803187541301,
    69.6531901505834,
    119.697512386512,
    146.278341090568,
    174.163272650881,
    66.6798874270700,
    92.6085425192528,
    33.3773423465147,
    93.2778593386287,
    91.2740910510437,
    25.5644598567864,
    127.986074078436,
    179.297645447706,
    85.4855915693017,
    35.1692066731760,
    58.9796693983065,
    11.7476625773845,
    12.0345762076835,
    5.33197847080138,
    110.093481064142,
    112.610142865873,
    60.9191227522176,
    150.902156940459,
    134.220637516031,
    187.967650867543,
    97.0309382362830,
    103.617568194679,
    157.840642687056,
    114.233648778567,
    153.298968886459,
    184.033220032724,
    42.0612666574222,
    121.622836269938,
    93.1450408870283,
    123.339978867358,
    40.6184247508511,
    135.520104809547,
    3.46311166440072,
    45.3215022992310,
    182.893207551847,
    153.686806522834,
    106.662528541336,
    13.6760432838497,
    39.9168464347177,
    2.40352612467802,
    193.314382513385,
    166.440138059126,
    89.0618120497533,
    198.099093142590,
    158.856876730720,
    97.7222336136382,
    26.1178508419076,
    42.4485038536737,
    166.222030944771,
    64.7574739347159,
    147.753542761717,
    31.9745517709280,
    146.294143096764,
    10.7388234380906,
    142.877905416757,
    24.3471284598161,
    196.808947597999,
    118.619639253241,
    53.9086410729642,
    86.4007181849945,
    186.102468468588,
    101.577061708059,
    12.8196010561623,
    131.822262561371,
    139.834403569021,
    229.433699519199,
    505.045617981367,
    606.252351368796,
    667.578839297293,
    980.092139190296,
    1123.63023680522,
    1111.25997225542,
    1378.01125067529,
    1402.85292595883,
    1144.54463853911,
    1058.34390120924,
    865.892148578281,
    714.375787585683,
    478.406204634355,
    497.283531239159,
    362.564423743021,
    120.754817395750,
    -11.0337012414243,
    98.5591164900949,
    80.8269251900109,
    43.9682637505169,
    173.299317121005,
    137.804613815463,
    34.2938766592282,
    1.80474574418563,
    33.8154255076641,
    41.2775541903009,
    180.324437761237,
    141.827979483321,
    26.3860099455417,
    85.0409378684853,
    132.289342850053,
    64.4766161966798,
    119.487358013550,
    206.464980194055,
    266.985069081021,
    318.048510285313,
    456.938756910344,
    396.369826567980,
    426.680998187605,
    492.123884322689,
    459.874455557868,
    503.945539721842,
    575.450011694529,
    610.593193526099,
    569.888801103353,
    603.800432396243,
    551.388643774173,
    553.506466190520,
    525.261894256246,
    668.096275066032,
    557.630863859944,
    680.994264698598,
    519.545830175117,
    615.778767601743,
    544.278843312791,
    581.949081070478,
    579.179543642238,
    471.072433856921,
    535.319704462187,
    476.758629882319,
    599.407507773085,
    534.063032228717,
    395.863048230835,
    417.755102836935,
    375.480824669450,
    336.835014379083,
    341.350521129402,
    323.555344407837,
    93.9897410258481,
    158.234105176158,
    83.7537909412156,
    147.905950066059,
    71.5046309129841,
    189.964416636134,
    150.029314200465,
    3.91549956796446,
    151.033428051992,
    182.360226312529,
    69.5507743866535,
    14.2570422258936,
    171.017723848068,
    18.8706696211022,
    109.913575237363,
    183.105025314006,
    104.402315761111,
    10.3930968503593,
    88.1817919762368,
    138.237845854239,
    52.2755078425420,
    179.181507888035,
    91.9424857498706,
    46.4038083645276,
    39.1885779158280,
    169.938768984112,
    148.321712128558,
    132.443072089508,
    21.4176799119500,
    167.234584141825,
    90.9830770647505,
    130.125989625606,
    180.884517085890,
    22.1411250159469,
    120.765901749962,
    3.27649325906334,
    18.2420803025082,
    181.134330523575,
    109.523795716005,
    128.841262272272,
    47.1753801300183,
    124.114727167288,
    15.7964545040209,
    129.150220106280,
    35.2599611569714,
    123.784955624661,
    194.064831672326,
    133.838693633822,
    66.3622653711419,
    91.5774031700203,
    4.98986919640962,
    104.620927373099,
    197.838391721093,
    144.672739381084,
    79.3889462581646,
    118.145963174597,
    114.635978302119,
    101.534858336368,
    29.1092771250017,
    58.1897461544073,
    100.228814324127,
    28.3739701666769,
    81.2766802907615,
    118.620636991050,
    161.875988957500,
    94.1197919454032,
    134.824335801813,
    151.435911475882,
    36.4199581164395,
    123.927835384930,
    153.985415645549,
    84.2172525888746,
    87.7977530760070,
    97.7560403066099,
    43.3665921971541,
    166.582476821081,
    100.308775265394,
    20.5463352502047,
    72.8719820090971,
    164.160404860701,
    24.5687050589029,
    129.871749305800,
    147.324943007597,
    142.132988013430,
    21.0669869363226,
    191.720893557038,
    84.7385760170489,
    112.022688800601,
    19.7565542222058,
    96.6235316437068,
    30.7249527087842,
    61.6939666528602,
    26.1832732630326,
    68.7037201858458,
    132.612075238148,
    103.240532679570,
    159.333377384778,
    215.319113555114,
    263.374792008358,
    449.696484491754,
    731.735887231460,
    877.901694755434,
    1047.96123169046,
    1064.73109092961,
    1347.48409301679,
    1422.77295305853,
    1305.41630514301,
    1145.26921885091,
    1034.55886555789,
    847.089313287907,
    650.447736141712,
    459.929321698028,
    286.982840931467,
    155.470528936055,
    51.6837176057083,
    -172.383226597193,
    143.074706215783,
    63.6373769029391,
    191.120730686823,
    5.79194355813910,
    79.4357613466303,
    55.5620033657641,
    72.3706194758713,
    156.090661042792,
    89.1328033299174,
    11.4624516133269,
    9.59886806277293,
    106.162975117628,
    153.353612184133,
    122.925838864826,
    186.486576522284,
    156.315349582339,
    315.316097711968,
    294.304854959846,
    380.781651135103,
    443.385541460559,
    448.078235340840,
    505.098014906379,
    442.034376744813,
    612.253568175559,
    450.196598866479,
    530.438891177008,
    657.699177929086,
    568.456282755609,
    602.697114965017,
    489.742112410444,
    646.716952145322,
    645.215903522531,
    542.697148441135,
    579.464279479089,
    551.740573404827,
    512.631718940218,
    537.030597320842,
    584.495023974838,
    583.381926855101,
    639.206354255076,
    543.272745356982,
    528.338322727897,
    623.550086935448,
    482.759344809739,
    422.522452893363,
    511.765284866441,
    530.385228652003,
    411.774608328771,
    377.523888933067,
    229.986575761896,
    202.029299207246,
    155.927888766721,
    122.165189937498,
    158.491372099525,
    167.580089819088,
    137.471679880739,
    16.2868200113592,
    161.228113802744,
    26.9553990510935,
    113.982869802872,
    114.938301254875,
    3.22055015837919,
    186.965663155292,
    122.956005319263,
    133.714978052989,
    84.3545617896259,
    140.553434721798,
    94.1393271748402,
    81.7785866100624,
    197.727203734296,
    97.0501479853463,
    23.4525478435924,
    171.617183257219,
    68.3951584791305,
    63.2758268340128,
    75.5054292505187,
    173.976332667814,
    106.286653624402,
    5.03110183100495,
    49.6710495095968,
    144.736096827177,
    86.4762356497604,
    52.2901165593681,
    37.8818124410664,
    42.8956028473326,
    98.9789163561836,
    6.60016642140913,
    74.5248521602036,
    71.3353345382009,
    54.9413077362291,
    52.8797846084676,
    148.903075760208,
    26.3367501583578,
    160.616800641986,
    60.8806119860223,
    68.5692416719947,
    131.868236851967,
    7.79289752263097,
    154.428567756624,
    138.016915851275,
    185.449089098803,
    12.4037169410532,
    137.493323948405,
    145.138977289954,
    169.305880657132,
    110.760014803173,
    168.479348957266,
    9.78377755774422,
    151.760888835787,
    135.199974823123,
    174.885818862057,
    66.1886471405182,
    103.699933892049,
    90.7890411374743,
    35.9006134354543,
    169.479891446206,
    9.28519492355846,
    104.719214384246,
    46.5407258594136,
    180.654780809041,
    108.251393069556,
    19.7369947070105,
    171.416726270834,
    8.54759383551076,
    28.4083496702446,
    43.4995299587680,
    155.492414896590,
    71.5211902977774,
    5.06475562225115,
    166.755921842273,
    72.6395626681658,
    157.712360622781,
    175.931932681508,
    135.301568158974,
    109.048812439682,
    179.777770696849,
    19.8986942176403,
    18.1878583354198,
    6.84786648957581,
    64.8348456382688,
    33.2131517270377,
    199.615718988391,
    83.0970402565117,
    150.866676879236,
    138.662699480482,
    154.128802201617,
    182.452016703414,
    62.1359536206265,
    190.943413768111,
    314.575763590542,
    567.440137234702,
    708.497324216617,
    878.817163684731,
    1019.60105191200,
    1140.00394637645,
    1232.51003609624,
    1427.98414679148,
    1321.66006649751,
    1003.62928892665,
    990.540675079144,
    851.226560247237,
    539.090055512149,
    470.573069235558,
    372.750958863040,
    221.747381777868,
    88.2490554545724,
    -43.3039878287500,
    112.166679290308,
    69.3052181979388,
    110.151129481545,
    4.22054181581675,
    147.354242589418,
    166.794347750947,
    167.263931894523,
    6.62407358730333,
    182.434468750902,
    18.9850356569800,
    170.181601713370,
    104.439963898787,
    3.27329114198505,
    25.8354313204447,
    118.634941033842,
    308.693023386662,
    236.466467972479,
    311.619267274219,
    360.757007941359,
    488.833103034632,
    526.795207298623,
    513.648308892932,
    590.327467100379,
    523.810980585445,
    644.689017432958,
    512.634615346122,
    609.538349267098,
    599.671440015392,
    543.363801361463,
    548.848631136392,
    633.657537186270,
    661.484013462832,
    515.248244120411,
    573.102337554472,
    658.151412075872,
    684.672846468626,
    686.244989969325,
    565.437133139840,
    558.035119056218,
    528.331445403324,
    538.836776449148,
    587.007756538240,
    566.879765815117,
    594.251199108914,
    413.292677541071,
    420.913938688677,
    456.003715813256,
    309.084988594131,
    293.853834208021,
    326.137999384501,
    43.7913795407358,
    65.6776177524592,
    92.3996408271920,
    70.4660333443528,
    14.7079121857396,
    101.038613686271,
    54.8399937243865,
    113.527087605027,
    5.50222237208851,
    122.743451684026,
    84.7223926647513,
    129.059143862697,
    61.2236133260506,
    58.1569163782636,
    86.1030880960887,
    110.054847352319,
    24.4922091009025,
    26.0850093785037,
    45.7576395883959,
    21.3846799795905,
    18.6074358656609,
    37.7145811485248,
    136.699101538510,
    108.296517684663,
    104.281384361059,
    188.363315158811,
    127.500247297553,
    143.711510970482,
    84.8883171965244,
    49.6715172853449,
    187.197456479247,
    160.425680434575,
    152.326764371502,
    12.3505679560137,
    181.330760019769,
    131.125624836911,
    189.589936835088,
    109.048386037906,
    61.0637569905172,
    17.7031968099326,
    84.3069027505259,
    73.5066735210130,
    170.505718134888,
    196.784795607795,
    10.7706239905782,
    71.4270338420109,
    199.813408432486,
    83.0034721768379,
    76.1295961577907,
    20.9159118447266,
    117.922444921805,
    29.2641268414527,
    75.3151430058563,
    187.270494390170,
    140.073908213476,
    48.5868281547590,
    148.423879801311,
    65.3275508160743,
    73.9918766449445,
    98.5588092245065,
    40.1236826008330,
    57.5134637591797,
    58.5186143662123,
    85.9687220216941,
    95.6225617885812,
    186.384002627510,
    167.245947232223,
    57.9951365101876,
    191.615000686650,
    144.609666863988,
    172.961572354672,
    104.649968792243,
    10.5537406755805,
    192.003071416024,
    134.441607043345,
    13.0933512374546,
    195.827228898240,
    58.9690061378827,
    189.981769271703,
    34.6839733553284,
    0.180919770611721,
    175.691087564792,
    170.107350856678,
    67.2817992011971,
    19.6660206748549,
    125.623820704219,
    80.0833393489025,
    185.610486166292,
    176.121131891490,
    123.816171335159,
    178.788152302503,
    41.8106603819644,
    51.6595506760104,
    0.824975002164896,
    18.0905379132074,
    119.164004645613,
    59.8625454510182,
    205.086759338665,
    328.477985020993,
    385.909307288972,
    556.668027063016,
    677.170967000486,
    912.699101213720,
    978.851242375740,
    1271.21068430366,
    1256.08168688982,
    1395.06477254356,
    1121.56009790180,
    1075.98729364508,
    786.278086566233,
    766.529280733913,
    511.824230396313,
    523.920511997776,
    278.339940675301,
    132.630202718794,
    -70.6972008750796,
    -24.3486039097483,
    102.429314554708,
    103.083709035996,
    93.7867357546218,
    30.8334316373662,
    43.0252161037252,
    129.034564599070,
    121.227833246321,
    36.4690249823906,
    173.538291248885,
    105.543620916587,
    194.907525931186,
    57.0969634461001,
    189.816200190165,
    121.521062112870,
    155.297561430702,
    177.031941552774,
    347.292827512536,
    456.336905842681,
    416.227279329093,
    452.397501518488,
    532.393123482705,
    526.791608139601,
    508.351274775834,
    544.476111435227,
    596.509936983994,
    563.506667473467,
    495.560992489536,
    533.940013697447,
    672.469824031948,
    610.886109860944,
    604.748678747271,
    686.680851705262,
    551.125791658729,
    681.607817086432,
    608.327222896113,
    640.743625970240,
    624.362190336645,
    508.263858612992,
    666.102237254819,
    545.550285657101,
    463.145537376735,
    454.597939538538,
    610.187972673503,
    509.843080313223,
    469.442972886742,
    474.828494995483,
    357.910555759830,
    415.365983295681,
    278.212795365640,
    291.059362332148,
    192.027428165455,
    145.284397030028,
    193.931659272030,
    152.428179726933,
    105.019168161846,
    89.3580489429154,
    127.672394979337,
    61.4275574250275,
    88.6811856587537,
    133.053989048657,
    164.455434884602,
    63.8042622503166,
    131.409007443205,
    101.080681503858,
    31.4892062313745,
    61.0153106797857,
    21.0202575342689,
    174.124363722579,
    135.790133099651,
    165.375044567524,
    189.213864795471,
    126.120782426737,
    102.680443668953,
    111.198994015121,
    197.486194048596,
    125.380301818639,
    170.403394776308,
    98.0501243608978,
    3.99175108399972,
    48.7662793064404,
    110.015012883605,
    20.3134032006735,
    94.8624166212193,
    34.9062336214219,
    65.0766264006736,
    22.0772627180965,
    85.6473021630269,
    143.798120653606,
    153.523317320655,
    185.437040507799,
    151.390809897422,
    66.4996420772324,
    176.111901915596,
    105.121947307118,
    53.4680571960918,
    33.6433640585571,
    9.00223735426775,
    34.1549869153596,
    185.155082479375,
    21.7247173340763,
    166.829868387705,
    30.3630025577732,
    171.175223204405,
    119.713505540997,
    39.5536519786087,
    159.506103970150,
    157.477130329183,
    19.1170166520515,
    34.2895564236957,
    120.562419401976,
    65.0196965664645,
    53.4569744194413,
    157.859950322271,
    123.322688562066,
    137.292841005816,
    139.486660205605,
    186.404118813500,
    24.0376174837225,
    121.377243204159,
    97.9735299602308,
    105.940276126803,
    44.3738262647829,
    149.636179834551,
    51.6307806587219,
    39.8227953598963,
    174.304674549023,
    5.43710030356956,
    7.26804270002113,
    87.5987333994057,
    13.1375256281497,
    195.877284835944,
    125.780012791309,
    131.265616635367,
    65.5812103889575,
    95.0999726335694,
    3.24836474289756,
    40.0056291337081,
    171.698946504486,
    13.5080209579981,
    62.1497120837581,
    165.324546555539,
    122.373682905017,
    182.920074721067,
    176.822087631506,
    49.0626067877937,
    191.640381391691,
    90.4593399726723,
    277.711628781865,
    342.970078738178,
    517.044272260568,
    552.335802419946,
    845.687078117879,
    933.060070298799,
    1023.72749702320,
    1269.25128318124,
    1300.93757190665,
    1362.89095583674,
    1163.28240771367,
    929.359615435477,
    875.747466279640,
    706.666384938536,
    481.742025172172,
    382.122901546740,
    137.043214423161,
    110.485454959306,
    9.57662057610168,
    43.3277353970371,
    73.7620334969255,
    183.478785853699,
    2.31460724524470,
    185.847040380186,
    138.683508107290,
    164.247404961407,
    171.547378090665,
    22.1153780578015,
    140.999880846246,
    110.333286246121,
    104.125558086687,
    62.7463500380276,
    32.2829840665721,
    63.9455555832943,
    134.213319786737,
    269.125708594610,
    350.621515824141,
    428.448386698564,
    347.042186650176,
    444.702883186985,
    525.615602489376,
    455.934707518212,
    583.512832428621,
    568.974225371562,
    513.595444142092,
    568.295065178841,
    638.967905806717,
    528.918056434078,
    491.394832710780,
    614.502379371701,
    604.662602204322,
    544.497694584040,
    683.988202434797,
    686.426843073791,
    594.629901707882,
    632.532216247012,
    590.815151086688,
    537.369388710597,
    473.294617778065,
    519.232275067492,
    581.200109558164,
    464.031175750848,
    460.855230700630,
    571.296818060269,
    493.823508387179,
    475.193306197527,
    328.106256417202,
    320.094528576062,
    385.060279181524,
    290.151038477009,
    14.1232846228911,
];

use qrs_detector::sampling::*;
use qrs_detector::typenum::*;
use qrs_detector::QrsDetector;

#[test]
fn test_simulated_signal() {
    let mut detector: QrsDetector<U60, U10> = QrsDetector::new(200.sps());

    let mut detections = 0;
    for &sample in SIGNAL {
        if let Some(_) = detector.update(sample) {
            detections += 1;
        }
    }

    assert_eq!(8, detections);
}
